{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta name="title" content="Sistema de ventas y pedidos online">
    <meta name="description" content="Sistema de ventas online de de hortalizas, frutas y verduras">
    <meta name="keywords" content="frutas,verduras,hortalizas,inventario,pedidos,online">
    <meta name="robots" content="index, follow">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="language" content="Spanish">
    <meta name="revisit-after" content=" days">
    <meta name="author" content="core inventory">
    <title>Inicio | {% block title %}{% endblock %}</title>

    {% if stripe_public_key %}
      <meta name="stripe_public_key" content="{{stripe_public_key}}" />
    {% endif %}
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi" crossorigin="anonymous">
    <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <link rel="stylesheet" href="{% static 'css/cardStyles.css' %}">
    <link rel="stylesheet" href="{% static 'css/estilosFormulario.css' %}">
    <link rel="stylesheet" href="{% static 'css/myStyle.css' %}">
    {% block css %}{% endblock %}
</head>
<body>
    {% if messages %}
    {% for m in messages %}
        {% if m.tags == 'success' %}
            <script type="text/javascript">
                const mensajeExito = ()=>{
                    const Toast = Swal.mixin({
                        toast: true,
                        position: 'top-end',
                        showConfirmButton: false,
                        timer: 3000,
                        timerProgressBar: true,
                        didOpen: (toast) => {
                        toast.addEventListener('mouseenter', Swal.stopTimer)
                        toast.addEventListener('mouseleave', Swal.resumeTimer)
                        }
                    })
                    
                    Toast.fire({
                        icon: 'success',
                        title: "{{ m }}"
                    })
                }
                mensajeExito();
            </script>
        {% else %}
        <script type="text/javascript">
            const mensajeError = ()=>{
                Swal.fire({
                    icon: 'error',
                    title: 'Oops...',
                    text: '{{ m }}'
                })
            }
            mensajeError();
        </script>
        {% endif %}
    {% endfor %}
  {% endif %}
  <header class="p-3 pb-0 mb-3 border-bottom ejemplo" style="background:#F37828;">
    <div class="container">
      <div class="d-flex flex-wrap justify-content-between">
        <a href="#" class="d-flex align-items-center col-md-1 col-12 justify-content-center text-decoration-none">
          <div class="logo"></div>
           <!-- <img src="img/logo.png" alt="" width="200px" height="40px">  -->
        </a>
        {% include 'Productos/search_bar.html' %}
        {% if user.is_authenticated  %}
        <a href="#" class="d-block link-dark text-decoration-none dropdown-toggle" id="dropdownUser1" data-bs-toggle="dropdown" aria-expanded="false">
          <img src="{% static 'img/person-circle.svg' %}" alt="logo usuario" width="32" height="32" >
        </a>
        <ul class="dropdown-menu text-small" aria-labelledby="dropdownUser1">
          <li><a class="dropdown-item" href="{% url 'Users:user_info' %}">Perfil</a></li>
          <li><a class="dropdown-item" href="{% url 'address:shipping_addresses' %}">Direcciones</a></li>
          <li><hr class="dropdown-divider"></li>
          <li><a class="dropdown-item" href="{% url 'logout' %}">Cerrar Sesión</a></li>
        </ul>
        </ul>
          <ul class="d-flex nav col-md-auto col-12 justify-content-center" >
            <li><a href="{% url 'index' %}" class="nav-link px-2 text-light me-sm-4 fw-bold">Inicio</a></li>
            <li><a href="{% url 'contact' %}" class="nav-link px-2 me-sm-4 text-light fw-bold">Contáctenos</a></li>
            <li><a href="#" class="nav-link px-2 text-light me-sm-4 fw-bold">Sobre nosotros</a></li>
          </ul>
          <ul class="d-flex nav col-md-auto col-12 justify-content-center">
            {% if user.is_superuser or user.is_staff %}
            <img src="{% static 'img/person-badge.svg' %}" alt="logo tarjeta" class="d-none d-sm-flex">
            <li class="px-1">
              <a href="/admin" target="_blank" class="nav-link px-2 text-light fw-bold">Panel de administrador</a>
            </li> 
            {% endif %}
            <img src="{% static 'img/credit-card-fill.svg' %}" alt="logo tarjeta" class="d-none d-sm-flex">
            <li class="px-1">
              <a href="{% url 'billing:create' %}" class="nav-link px-2 text-light fw-bold">Métodos de pago</a>
            </li> 
            <img src="{% static 'img/box-seam.svg' %}" class="d-none d-sm-flex" alt="logo pedidos">
            <li class="px-1">
              <a href="{% url 'Orders:orders_list' %}" class="nav-link px-2 text-light fw-bold">Mis Pedidos</a>
            </li>
            <img src="{% static 'img/cart.svg' %}" class="d-none d-sm-flex" alt="logo carrito">
            <li>
              <a href="{% url 'Carts:cart' %}" class="nav-link px-2 text-light fw-bold position-relative">Mi Carrito
                <span id="add-product" class="position-absolute top-10 start-100 translate-middle badge rounded-pill bg-danger"></span>
              </a>
            </li>
            {% if promo_code and not promo_code.send %}
              <img src="https://images.emojiterra.com/google/noto-emoji/v2.034/512px/1f381.png" onclick="location.href='{% url 'promo_code:send_promo_code' %}'" alt="logo codigo promocion" width="35px" height="35px" class="d-none d-sm-flex ms-4 promo_code">    
            {% endif %}
        {% else %}
          <a href="{% url 'Carts:cart' %}" class="col-xl-1 col-sm-12 text-center position-relative"> 
            <img src="{% static 'img/cart.svg' %}" alt="" width="32" height="32" >
            <span id="add-product" class="position-absolute top-10 start-90 translate-middle badge rounded-pill bg-danger"></span>
          </a>
          <ul class="d-flex nav col-md-auto col-12 justify-content-center " >
            <li><a href="{% url 'index' %}" class="nav-link px-2 text-light me-sm-4 fw-bold">Inicio</a></li>
            <li><a href="{% url 'contact' %}" class="nav-link px-2 me-sm-4 text-light fw-bold">Contáctenos</a></li>
            <li><a href="#" class="nav-link px-2 text-light me-sm-4 fw-bold">Sobre nosotros</a></li>
          </ul>
          <ul class="d-flex nav col-md-auto col-12 justify-content-center ">
            <img src="{% static 'img/person-fill.svg' %}" class="d-none d-sm-flex">
            <li><a href="{% url 'login' %}" class="nav-link px-2 text-light fw-bold">Iniciar Sesión</a> </li>
            <img src="{% static 'img/people-fill.svg' %}" class="d-none d-sm-flex">
            <li><a href="{% url 'register' %}" class="nav-link px-2 text-light fw-bold">Crea tu cuenta</a></li>
          </ul>
        {% endif %}
      </div>
    </div>
  </header>
  {% block content %}
  {% endblock content %}
  <script type="text/javascript">
    const notification = document.getElementById("add-product");
    window.addEventListener('load', event => {
      notification.textContent = {{cart.products.count}}
    })  
  </script>
  <!--- JQuery -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  <!-- JavaScript Bundle with Popper -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-OERcA2EqjJCMA+/3y+gxIOqMEjwtxJY7qPCqsdltbNJuaOe923+mo//f6V8Qbsw3" crossorigin="anonymous"></script>
  <!-- Validaciones del formulario -->
  <script type="text/javascript" src="{% static 'js/validacionFormularios.js' %}"></script>
  <script type="text/javascript" src="{% static 'js/steps-order.js' %}"></script>
  {% block js %}
  {% endblock %}
</body>
</html>